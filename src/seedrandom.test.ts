import { describe, expect, test } from 'bun:test';
import { seedrandom } from './seedrandom';

type Case = [seed: string, seq: number[]];

const cases: Case[] = [
  [
    '',
    [0.23144008215179881, 0.27404636548159655, 0.7901279251811976, 0.40384160557189036, 0.1321140086237582, 0.6182831712505996, 0.9154111225454327, 0.1502617438764764, 0.9706087980957805, 0.4651304822486096]
  ],
  [
    'a',
    [0.43449421599986604, 0.5451403460013228, 0.3578386258898537, 0.5680674010372789, 0.5891631034580515, 0.6363726288676872, 0.005222270723581011, 0.33566655610801654, 0.8443067926032052, 0.18074943459681073]
  ],
  [
    'aa',
    [0.43449421599986604, 0.5451403460013228, 0.3578386258898537, 0.5680674010372789, 0.5891631034580515, 0.6363726288676872, 0.005222270723581011, 0.33566655610801654, 0.8443067926032052, 0.18074943459681073]
  ],
  [
    'aaa',
    [0.43449421599986604, 0.5451403460013228, 0.3578386258898537, 0.5680674010372789, 0.5891631034580515, 0.6363726288676872, 0.005222270723581011, 0.33566655610801654, 0.8443067926032052, 0.18074943459681073]
  ],
  [
    ' a ',
    [0.4673059283840093, 0.6865749027608377, 0.9966942773805212, 0.6322507228376318, 0.14363521609497393, 0.9922967673682007, 0.7635356792804441, 0.5191758587387744, 0.9328506088479627, 0.00299472701827255]
  ],
  [
    'abc',
    [0.7319428070286753, 0.6472995620587413, 0.7150830336207971, 0.6316332598487158, 0.39283784326843896, 0.27854243237980114, 0.5119392717406288, 0.772057660571673, 0.38548795873371666, 0.8063661558618387]
  ],
  [
    'ABC',
    [0.9781582436065149, 0.4959450383426717, 0.9251983483610926, 0.3561197930275859, 0.874305088083228, 0.30573186151955734, 0.12012849167367405, 0.2937608938285652, 0.5111759554028624, 0.9243913866774068]
  ],
  [
    '$$$',
    [0.8108795842990106, 0.5465271362737767, 0.7465735067569411, 0.0659799325449975, 0.4615530758886473, 0.8636447069615855, 0.5513575530348734, 0.712023986696547, 0.7583467067743973, 0.7550803395537231]
  ],
  [
    ':)',
    [0.13491173416925914, 0.02888223590011537, 0.7671639728647902, 0.18313384974901972, 0.8857926530534147, 0.38094864987158594, 0.9316305857022792, 0.4909257284310783, 0.33765779775165633, 0.024944668024253]
  ],
  [
    '\\x0',
    [0.398917497414866, 0.26311458662095727, 0.8717834158966685, 0.3521078913644339, 0.9821429913605073, 0.781396106708989, 0.3694811027189041, 0.14991696155969308, 0.29934605440817497, 0.1567005993628246]
  ],
  [
    'hello world',
    [0.5407725273692652, 0.16887340109512985, 0.024502771862726563, 0.7853673151561749, 0.7321669404757115, 0.3818231185893145, 0.9057538110212471, 0.966624232416151, 0.4667999223290858, 0.3031796829678031]
  ],
];

describe('seedrandom()', () => {
  test.each(cases)('seed %p produces %p', (seed, seq) => {
    const EPSILON = 10;
    const rand = seedrandom(seed);
    for (const val of seq) {
      expect(rand()).toBeCloseTo(val, EPSILON);
    }
  });
});
