import { describe, expect, test } from 'bun:test';
import { seedrandom } from './seedrandom';

type Case = [seed: string, seq: number[]];

const epsilon = 18;
const cases: Case[] = [
  ['',    [0.26642920868471264839, 0.00032974570058286190, 0.22327202744781970978, 0.14620214793831110001, 0.46732782293111085892, 0.54504908272065222263, 0.61525138444267213345, 0.64898537984117865562, 0.45600721263326704502, 0.58121896767988801003]],
  ['a',   [0.56558375828899443150, 0.21950005996040999889, 0.83395106578245759010, 0.53908153600059449673, 0.32204846641980111599, 0.48467842047102749348, 0.32464219932444393635, 0.54816391877830028534, 0.18388995551504194736, 0.19784286571666598320]],
  ['aa',  [0.03709665220230817795, 0.15748474816791713238, 0.58439007448032498360, 0.91064841672778129578, 0.05015428713522851467, 0.49565216107293963432, 0.77615774585865437984, 0.47742893546819686890, 0.64454866177402436733, 0.96217032452113926411]],
  ['aaa', [0.88246102794073522091, 0.48419996490702033043, 0.63660403992980718613, 0.37823211587965488434, 0.36461846483871340752, 0.61759386677294969559, 0.49234412331134080887, 0.48361406079493463039, 0.50568547076545655727, 0.91679247841238975525]],
  [' a ', [0.34209202136844396591, 0.37898586411029100418, 0.02631480805575847626, 0.68735614512115716934, 0.66156019316986203194, 0.95761162554845213890, 0.95820962474681437016, 0.21058785170316696167, 0.26575098186731338501, 0.68311524530872702599]],
  ['abc', [0.35655662906356155872, 0.06145061063580214977, 0.00700295856222510338, 0.83099995693191885948, 0.39279840234667062759, 0.93180885841138660908, 0.55420087720267474651, 0.80884295003488659859, 0.20218154019676148891, 0.05422637262381613255]],
  ['ABC', [0.68036065250635147095, 0.23741540662012994289, 0.77596384217031300068, 0.22964829136617481709, 0.42663023923523724079, 0.59823388629592955112, 0.19548558909446001053, 0.10065145022235810757, 0.02335851965472102165, 0.12442444730550050735]],
  ['$$$', [0.99258922669105231762, 0.84773325920104980469, 0.00885742250829935074, 0.44040242512710392475, 0.20938585675321519375, 0.87618545768782496452, 0.75549345836043357849, 0.99775230442173779011, 0.23799412511289119720, 0.57623135205358266830]],
  [':)',  [0.56940524675883352757, 0.90141620743088424206, 0.32084315805695950985, 0.47297598840668797493, 0.02323046140372753143, 0.79783844249323010445, 0.91657537315040826797, 0.09482141118496656418, 0.55994274350814521313, 0.01875048922374844551]],
  ['\\x0', [0.22459370107389986515, 0.49888849398121237755, 0.63398414338007569313, 0.34471307089552283287, 0.83068765723146498203, 0.22865171707235276699, 0.10648532095365226269, 0.75409536366350948811, 0.48391545587219297886, 0.52306541334837675095]],
  ['hello world', [0.81788194319233298302, 0.51678979373537003994, 0.86809214693494141102, 0.89249841636046767235, 0.76243055262602865696, 0.34634335059672594070, 0.54264091979712247849, 0.41373094660229980946, 0.88864226848818361759, 0.27010386413894593716]],
];

describe('seedrandom()', () => {
  test.each(cases)('seed %p produces %p', (seed, seq) => {
    const rand = seedrandom(seed);
    for (const val of seq) {
      expect(rand()).toBeCloseTo(val, epsilon);
    }
  });
});
